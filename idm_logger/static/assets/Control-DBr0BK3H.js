import{a as l,o as s,f as i,h as f,n as $,t as u,r as d,v as z,S as C,K as E,y as v,g as b,b as o,F as N,x as B,d as c,w as k,j as w}from"./index-Baxp1Yl2.js";import{s as W}from"./index-JBLZ3bgr.js";import{s as j}from"./index-D1RVSbeV.js";import{s as R}from"./index-4SjfGYuF.js";import{s as U}from"./index-PHxPGNvU.js";import{s as F}from"./index-BlRpwonz.js";import{s as H}from"./index-CLfkFwyV.js";import{_ as L}from"./ErrorDisplay-5yFw6YB-.js";import"./index-CLs7nh7g.js";import"./index-BSOrfvvy.js";import"./index-DI-YwfG4.js";const M={class:"flex items-center justify-center"},P={key:0,class:"ml-2 text-gray-400"},D={__name:"LoadingSpinner",props:{size:{type:String,default:"md"},text:{type:String,default:""}},setup(p){const m=p,r={sm:"w-4 h-4 text-sm",md:"w-6 h-6 text-base",lg:"w-8 h-8 text-lg",xl:"w-12 h-12 text-xl"};return(x,n)=>(s(),l("div",M,[i("div",{class:$(["animate-spin text-primary-500",r[m.size]])},[...n[0]||(n[0]=[i("i",{class:"pi pi-spinner"},null,-1)])],2),p.text?(s(),l("span",P,u(p.text),1)):f("",!0)]))}},T={class:"p-4 flex flex-col gap-4"},q={key:0,class:"flex justify-center items-center py-12"},A={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-4"},I=["title"],O={class:"flex flex-col gap-3"},G={class:"text-gray-400 text-sm"},K={key:0,class:"bg-yellow-900/50 border border-yellow-600/50 text-yellow-200 p-2 sm:p-3 rounded text-xs sm:text-sm"},Z={key:1,class:"bg-info-900/50 border border-info-600/50 text-info-200 p-2 sm:p-3 rounded text-xs sm:text-sm"},J={key:2,class:"flex flex-col gap-2"},Q={key:3,class:"flex flex-col gap-2"},X={key:0,class:"text-gray-500"},me={__name:"Control",setup(p){const m=d([]),r=d({}),x=d(!0),n=d(null),y=d({}),h=z(),V=C();E(async()=>{try{const a=await v.get("/api/control");m.value=a.data;try{const t=await v.get("/api/data");m.value.forEach(e=>{r.value[e.name]=t.data[e.name]})}catch{}}catch(a){n.value=a.response?.data?.error||a.message}finally{x.value=!1}});const _=async(a,t)=>{y.value[a.name]=!0;try{const e=await v.post("/api/control",{sensor:a.name,value:t});e.data.success&&h.add({severity:"success",summary:"Erfolg",detail:e.data.message,life:3e3})}catch(e){h.add({severity:"error",summary:"Fehler",detail:e.response?.data?.error||e.message,life:5e3})}finally{y.value[a.name]=!1}},S=a=>{const t=r.value[a.name];t!=null&&(a.eeprom_sensitive?V.require({group:"eeprom",message:`Register: ${a.name}
Neuer Wert: ${t}

Dieses Register hat begrenzte Schreibzyklen. Häufiges Schreiben kann die Hardware beschädigen.`,header:"EEPROM Warnung",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Abbrechen",severity:"secondary",outlined:!0},acceptProps:{label:"Fortfahren",severity:"danger"},accept:()=>{_(a,t)},reject:()=>{}}):_(a,t))};return(a,t)=>(s(),l("div",T,[t[3]||(t[3]=i("h1",{class:"text-2xl font-bold mb-4"},"Manuelle Steuerung",-1)),x.value?(s(),l("div",q,[o(D,{size:"xl",text:"Lade Steuerungselemente..."})])):n.value?(s(),b(L,{key:1,error:n.value,onDismiss:t[0]||(t[0]=e=>n.value=null)},null,8,["error"])):(s(),l("div",A,[(s(!0),l(N,null,B(m.value,e=>(s(),b(c(W),{key:e.name,class:"bg-gray-800 text-white"},{title:k(()=>[i("div",{class:"text-base sm:text-lg font-medium truncate",title:e.name},u(e.name),9,I)]),content:k(()=>[i("div",O,[i("div",G,u(e.description),1),e.eeprom_sensitive?(s(),l("div",K,[...t[1]||(t[1]=[i("i",{class:"pi pi-exclamation-triangle mr-1"},null,-1),i("strong",null,"ACHTUNG:",-1),w(" EEPROM-sensitiv! Begrenzte Schreibzyklen ",-1)])])):f("",!0),e.cyclic_change_required?(s(),l("div",Z,[...t[2]||(t[2]=[i("i",{class:"pi pi-info-circle mr-1"},null,-1),i("strong",null,"HINWEIS:",-1),w(" Zyklische Änderung empfohlen ",-1)])])):f("",!0),e.enum?(s(),l("div",J,[o(c(U),{modelValue:r.value[e.name],"onUpdate:modelValue":g=>r.value[e.name]=g,options:e.enum,optionLabel:"name",optionValue:"value",placeholder:"Wert wählen",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options"])])):(s(),l("div",Q,[o(c(R),{modelValue:r.value[e.name],"onUpdate:modelValue":g=>r.value[e.name]=g,type:"text",placeholder:"Wert"},null,8,["modelValue","onUpdate:modelValue"]),e.min!==null||e.max!==null?(s(),l("small",X," Bereich: "+u(e.min??"-∞")+" bis "+u(e.max??"+∞"),1)):f("",!0)])),o(c(j),{label:"Schreiben",icon:"pi pi-send",onClick:g=>S(e),loading:y.value[e.name]},null,8,["onClick","loading"])])]),_:2},1024))),128))])),o(c(F)),o(c(H),{group:"eeprom",class:"eeprom-confirm-dialog"})]))}};export{me as default};
